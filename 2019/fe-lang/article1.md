编程语言的两种极端态度
关于编程语言我首先想讲一个问题，其实关于编程语言经常会看到两种非常极端的态度：
λ	第一种就是说他觉得某某语言最好，某某可以自己填入你喜欢的内容。如果跟他讨论的时候你喜欢的语言和他喜欢的语言不是同一个，他可能就是鄙视的表情。
λ	另外一种觉得所有语言都一样，当我们跟他讨论这个语言当中的特性有优劣，他也会给你鄙视脸。

虽然这两种态度看似完全截然相反，但是我认为实际上这两种极端态度背后原因是类似的。人们总是高估短期，低估长期。作为编程语言来讲，以我的看法不太可能是项目成败的决定性的因素。但是长期来看，一个编程语言的好坏，以及使用语言的新特性会影响团队长期的生产力。我今天这个题目是专门针对前端开发来讲的，就是前端开发的编程语言。

前端开发编程语言的特点
前端开发编程语言有自己的独特特点和一般的讨论的编程语言有特点。如果我们观察前端开发的编程语言有两个重要特点：
λ	第一是平台高度相关的。什么叫平台高度相关呢？比如说如果我们使用Flutter，到目前为止我们必须一定使用Dart语言，这样一种高度相关，比如说后端开发者没有这样的一个高度相关了。这样一种相关性也会使整个技术栈的选型语言和平台无法完全分开的。比如说因为你看到了Flutter这个平台非常的好，所以你就一并的选择了Dart语言，但是很有可能你其实不是特别喜欢Dart语言，有这个情况。也有另外一种情况，可能根据你团队现有的情况你可能说我就是现有团队对于Java已经很熟了，不想离开这样一个语言，在这样一种情况下，很遗憾你现在也没有办法选择Flutter的平台。在这里面会发现我们在前端开发过程当中编程语言有这个约束跟平台高度相关。
λ	第二领域高度相似。不管哪一个语言，如果我们讲前端开发语言，它其实都是在意前端这样一个特定的问题领域之下，所以他有很多的问题是非常相似的。这个和我们经常在后端语言也有一个区别，后端语言经常会有多语言的混合编程，每个语言可能做自己非常独特的事情，每一个语言也可能有一些独特的特点。比如说NM特点是分布式系统，比如说GO就是网络层比较擅长，但是对前端语言你会发现相似性非常高。
编程语言的过去
我们了解过去的情况，这是比较近的过去，没有讲过早，比如说最早移动开发是用J2ME，这个已经太早了。所以还是在我们Android、IOS时代来看。

过去三个主要平台的语言在Web就是JavaScript，Android就是Java，IOS就是Objective-C。在Web平台还有其他语言，比如说我们见到的ot.js。但是从整个发展来看，虽然我们现在还是可以用各种语言编译，但是总体趋势还是重新回到了JavaScript。

Android理论上可以由Java等其他语言可以编译过去，但是这样一种实践，实际不是特别流行。虽然在Java有很多的平台。由于各种各样的原因，虽然可以用，但是不用。比如说当你用另外一个新语言，可能标准库是独立的，对于前端来讲有很大问题你发布的包，有一个大小的限制，如果你使用独立的语言，虽然可以编译过去，但是有可能带上他的库，就使整个包大小变大，这对我们来说是一个障碍。如果你是一个后端编程，这个障碍基本不存在的。所以总体来讲，虽然是存在这个可能，但是实际上在实践上，在Android、IOS平台上我们还是比较少用其他的语言。

使用编程语言遇到的问题
JS的问题
过去我们用这几个语言会遇到一些问题，什么问题呢？我们先讲JS的问题是什么？主要就是总结为不适合PITL，就是大型编程。大型编程就是这个项目有比较长的生命周期，第二你这个项目有比较大的团队需要多人协作。但是JS这个语言当年设计的时候，不是为这样一个场景设计，是一个脚本语言。一开始设计就是为了方便使用，所以在很多方面并不适合大型编程。比如说大家都会看到有一个弱类转化的问题会造成我们很多问题。

Java的问题
Java是什么问题呢？其实Java本身是非常好的语言，到目前为止仍然是我们非常重要的工业语言。Java的问题就是Oracle。Java本来是通用语言，有很多用在服务器端的。这个语言的演化要考虑服务端很多需求，不能简单因为前端或者移动端有一些新的需求，就把这个语言特性加进去，还是要考虑：更广泛的应用这样一个特性是不是值得加进去。

Objectivc-C的问题
Objective-C这是非常有趣的语言，它的问题是和其他主流工业语言使用上存在一定的差别。最简单如果看Objective-C代码的命名规范，都是非常的长，为什么那么长呢？一个原因是原本在其设计上就鼓励很长的名字。第二个原因是参数和前面的方法名字合在一起构成整个的名字。如果你在用Java和JS切换还没有那么难，但是切换到Objective-C就障碍比较大。
编程语言的现状
我们看一下现在编程语言的状况，发现很明显的改变。在JS这个领域，大量新的应用转用TypeScript。在Java有更多应用使用Kotlin。对于IOS就是Swift。另外有一个新的平台就是Flutter使用Dart。

我们会发现这个不知道是不是巧合，所有重要的平台端都在比较短的一段时间内，从老的语言进化到新的语言。

编程语言都平台钦定
这样的一个情况，与一般的编程语言有什么特别的不同呢？你会感觉到前端的编程语言似乎都被平台所钦定。我们回头看这几个语言，比如Kotlin就是Google宣布作为首要支持的语言。Swift是苹果主推的。TS虽然不是新的语言，但关键问题是它本身是JS和类系统的结合，所以TS跟JS有着非常紧密的联系。JS所有类里面只能使用JS。当然还有Dart，Dart是Flutter钦定的语言。所以我们感觉都是钦定。

编程语言的跨端和全栈
虽然是平台钦定的，但是又发现一个特征，所有的语言他们自己都不满足于在单平台，他们都会有这样一个趋势：走向跨端和全栈。比如对TS或者JS这样一个语言来讲，Node.js在全栈开发上已经存在很多年了。我们发现Kotlin可以编译成JVM、JS，也可以编译成Native。Dart有VM，也有JS，也有Native。相对来讲，Swift是不能够做到全端的一个语言，但是它也是发展成全栈的，我们会发现Swift在SeverSide上面推进。我们发现这些语言看上去与平台不相关，但是都在向外扩展。

TS和JS仍然是跨端和全栈能力最强的语言
这些语言当中，目前来看，TS和JS仍然是跨端和全栈能力最强的语言。为什么始终保持这样呢？
λ	一是我们看其实所有的端包括Android、IOS设备都是有JS引擎的。
λ	二是大家发现JS本身就是一个Target。基本现在新语言一定都是选择能够编译到JS当中的。
λ	三是实际上JS主要弱点看前面讲几个语言都可以编译到Native，但是JS没有这个能力。当我们发现JS在Native性能方面有所不足，我们就可以考虑通过使用其他的语言编译到这个里面做补充，这样在JS方案补上这一环。
总体来看，JS、TS仍然是目前跨端和全栈能力最强的语言方案。


在前面提到这些新语言，主要都是在前端或者移动端平台。但是实际上我们也有其他的语言。但是那些语言不是说不想做前端，我们发现很多其他语言都尝试过往前端发展，但是都不是很成功。我们可以看到基本上从前到后比较容易，从后到前比较难。这个当然有很多原因了，我这里不具体展开了，大家可以考虑后面有一些什么样的因素，但是总体来讲，我觉得可能会有这样一个情况的。

新一代前端编程语言趋同
我们前面看到了这么多的不同的新的前端的语言，或者说移动端的语言，其实他们都会有不同的地方，因为在他们整个的发展过程当中，一定要考虑之前所有的技术上的资产。

语法相似
我们发现新语言有趋同趋势，新一代的语言语法比原来更加接近和相似。在很多新的语法上发现换一个语言也有，比如说Node.js使用是 ?. 访问的属性，包括Dart虽然现在不支持，将来马上也要支持。在JS已经进入了，就是本月月初的时候，语法上有趋同的趋势。这里最明显就是Objective-C到Swift的转变，Swift转变跟其他语言是非常像的。

支持静态类型
另外我们发现所有语言走向静态类型，TS和JS把这个静态加上了。包括其他几个语言都是静态类的语言，像Dart也是像TS一样，但是本身也是一个静态类型。静态类型的引入，主要还是为了前面讲的大型编程。包括IDE也有代码提示、自动完成的能力。

但是我们要注意这个静态类型和以前Java的语言有区别的，不仅是静态类型，而且大量使用自动类型的推导。使我们的很多代码并不需要在每个地方都声明类型，既获得了静态类型的好处，同时开发者体验上比Java传统静态类型更好。很多时候我们甚至觉得，如果你的代码是比较多的代码，尤其和UI接触的时候，发现和动态语言代码没有什么区别。

支持泛型
不是所有语言都支持泛型，比如说GO，但是GO2.0支持泛型。泛型对于应用语言非常重要，因为我们日常开发中有容器类，泛型对于这个来讲非常重要。另外比如说前面提到的Null safe，前面提到所有编程语言都加入这样一个特性，并且语法基本一样，大同小异。

另外一点就是说除了我刚刚讲的这个之外，还有看到语言特性也有一个趋同的倾向。比如说举一个例子，异步编程在整个端非常重要，因为整个端基本上UI是单线程做的，这种情况下，处理很多异步的操作变成必然要做的事情了，而且面临的挑战其实在各个语言里面非常类似。所以整个异步编程里面，发现新语言有一个趋同过程。比如说很多都是基于Promise或者Future模式，在此基础之上，有可能会使用Async和Await，包括Swift将来也会加入。

顺便讲一下，明天的论坛在这个异步编程有整个Dart异步编程模式。Dart就是Web Worker，在编程模式几乎是完全一样的。

在开发体验上的相互借鉴
另外我觉得还有一个趋同：在开发体验上互相借鉴。董博士（Flutter团队高级研究员：董韬博士）提到了热重载，这个只有Web开发者能够一直比较好使用这个。但是其他端也都引入这个。比如在Android上Instant  Run，Flutter也提供了热重载。Swift没有官方的，但是有官方方案。总体来讲，整个体验是往这方面靠拢的。这个对于我们开发效率会有提高的。

小结
为什么我们在语法、语言特性、开发工具和体验上出现趋同？

第一，前面几个语言生态位，有的语言生态位不一样，比如说Facebook本身是Okmer的语法。那样一些语言都会有特色，但是生态位跟我们前面讲的不一样，他可能就是所谓比较小众的语言，适合在特定的领域或特定场合。但是我们现在的前端语言尽管可能只是在一个品牌上，它们的目标却都是希望向外扩展的。所以他们是以主流工业语言设计和推广的。在这样一个生态位上，其实所有的东西就会有一个相似性。因为进入主流工业语言，传统的Java代码，跟它相似性比较重要。

第二，整个前端开发者的流动，本来原来是Web前端开发者，现在做IOS或者Android的开发，或者Android进入Web。这个趋势非常非常明显。我举一个例子来讲，比如说有一次听Rect Native的会场，有一半以上是IOS来听。恰恰因为这个流动性，我们希望障碍越少越好，语言相似性就很重要了。

第三，本质因为都是一个端，问题领域非常相似，比如是前面已经讲过了异步编程在几个里面都会面对的问题。既然他的问题领域是相似的，他所做的最后的结果也可能是会逐渐的走向趋同。因为好东西大家都想用。在这一点上我想特别讲一下UI DSL，刚才有人提到了。


UI DSL
在JS当中看到JSX，在Kotlin看到ANKO，在Swift发现了刚刚发布的SwiftUI，本身Flutter本身就是UI的框架。这四个东西，其实在很多地方是非常相似的。当然我们直觉会认为它们有一些不同，比如说我们觉得JSX是类似HTML，但是后面是靠近语言本身能力。表面有这个差别，其实是由一些原因造成的。

为什么在JS和TS出现JSX，主要原因是JS或者TS这个语言受到很多既往的限制，使得不太适合在语言内部做一个DSL。但是Kotlin在设计之初把DSL作为设计目标，所以做出比较好看的DSL。Flutter是因为Dart比较有意思，Dart在很多方面比较保守设计，所以跟JS有相似问题，他做出的DSL不是很好看。不过董韬博士（Flutter团队高级研究员）已经讲了，已经做了很多改进，包括有一些语言层面的改进，使得DSL看得更清楚，另外通过IDE的改进，也能够弥补在语言层面没有办法完全解决的问题。这个也就是UI-AS-CODE，整体会有这方面的趋势。

怎么达到这个趋势？有两个方向：

λ	第一是声明式的DSL代码化。Web端就是这样，原来我们HTML是声明式，但是现在HTML变成了JSX形式。第二个比如说我们传统CSS，在整个体系崇尚用CSS  in  JS。就是把原本声明式的专用DSL转换到代码本质上共存的状态。

λ	另外看到其他语言，它是命令式代码的声明化，这个不多解释了。通过语言的本身的能力能够把DSL做出来。它们在本质上是殊途同归的。最后达到的就是一个声明性DSL和命令式程序的结合。
React Hooks
React 推出了新的React Hooks。React Hooks可以理解他们推出新一代的UI DSL。像我前面讲趋同的问题，在这点马上可以看出来，React Hooks推出之后，我们整个Android社区、Swift社区，包括Flutter社区可以看到马上有开源项目出来，把这个React Hooks类似的方式搬运到平台上。所以可以看到，我前面讲的三点其实有互相影响借鉴的过程。React Hooks作为现在我认为还是一个新的而且比较先进，确实有比较多的优点的解决方案，我们期待他也可能会在不久将来进入到各个平台里面去。
Vue
在不久之前在Qcon上面，Vue 作者介绍了Vue 3的设计，大量借鉴了React Hooks的方式，但是跟React Hooks还是有一些区别。我们前面讲UI-as-code，这里有一个共性，但是这里想讲有一个误解，到底template和render的界限在哪里？在Vue 3当中做的一个事情就是template和render做了完美结合，因为template是真正声明式的东西，从template提取所有静态信息。

前面讲的UI-as-code虽然是声明式的，但是本质仍然是code，很多地方没有办法通过静态分析完整得到哪一个东西发生了变更，依赖关系是什么。在对于Vue来讲尽量使用template充分利用静态信息，同时局部信息可以使用render，就是通过代码实现这可以使整个变更最小化。 这里不展开了，大家可以了解，这是目前我看到最先进的方案。

预测未来
预测未来是很危险的事情，90%的概率是错误的。首先有一点是未来会越来越相似。因为前面讲了看到这样的趋势，我觉得从很多方面，一方面确实看到确实是这样，不同特性如果被证明好的语言特性，或者被证明为开发者是有价值的，那么它会在不同前端语言和平台当中进行普及。

但是另外一方面也要注意，毕竟语言还是有差异的。感觉Swift是相对比较激进的语言，被人诟病每个月都要学一门新语言。就是Swift。但是Swift发展到现在这个版本，基本之前很多东西已经相对稳定下来了，我们认为从狂飙的阶段进入相对稳定的阶段。但是总体我们还是会感觉，Swift这个语言是不怕做一些激进的事情。

Kotlin的定义表明它是一个相对比较中庸的语言。可能很多人不同意我的看法，觉得Kotlin加入非常多、好的先进语言的特性，但是这个中庸是和Java整个平台下其他语言比较得出的结论。Kotlin强调的是还可以使用Java现有的东西。所以我觉得它其实是比较中庸的，中庸在这里不是贬义词，是一个很好的特性。

Dart这个语言，其实是一个相对比较保守的语言，比如说引入所有语言新特性的方面非常缓慢，甚至有时候迟缓。Dart保守不一定是坏的，保守有好处，Dart本身就是搞VM，VM本身需要确保某个特性在VM可以高效运行，这实际上对于语言来说有很大的约束。

最后是TS和JS，前面三个语言都是有主导者，比如说Swift主导者是苹果，Dart主导者是Google，Kotlin是有比较强的控制。而TS未来并不取决于Microsoft，其他都是JS带过去的。JS这个语言是比较典型委员会语言了。所以在这个里面其实没有一个非常强势主导方，而是通过委员会改进的。在JS新的特性既有非常激进的特性，也有非常保守的态度，有一些特性不愿意加。在这个里面打了一个问号，可能也是长期看来整个TS、JS面临的挑战。因为整个语言发展上，比较缺乏主心骨。

未来的变数
这里还想讲就是未来当中一个变数是什么？我们前面没有提到的小程序。大家知道，在整个来看我们有几个端，前面提到了Web端，包括Android、IOS端。对于中国开发者来讲，还有另外一个端是小程序，而且准确讲他还不是一个端，他是有很多很多小程序，包括小程序、包括快应用等，他们虽然是非常相似，但是又有一些不同，所以在这个地方其实也是一个非常大的一个挑战，同时我也觉得这也是一个很大的机遇。

现在多端的方案对于中国开发者来讲大家希望把小程序一并解决。这个时候提一个讲的Flutter for Web，可能对于中国开发者来讲还期待有Flutter  for 小程序。如果小程序不能解决，在很多的选型场景下，可能就没有办法选择Flutter，可能就得选基于TS或者JS的方案，当然这个要看小程序本身的框架支持怎么样。这可能是一个问题。

前端选型
我们前端选型最大的约束点第一轮平台需求到底跨多少，这是非常强的因素。我是Flutter在这上面有一些问题。

第二个事情就是团队的背景，这个团队本身熟悉一个怎么样的开发工具和开发语言的生态。我们基本还是从这两点进行出发。

中国公司和产业是否会诞生新语言
其实我们前面看到的新语言像Dart是Google做的，像Swift是苹果做的，其实我们觉得中国现在头部的公司，从规模来讲，我认为已经不亚于他们了，但是我们到现在来讲都没有看到任何一个中国公司会有做语言的公司。大家通过这个可能会有一个疑问，说为什么一定要做新语言呢？

这里想讲一个，很多时候我们用即有的语言就可以了，但是我们想一下，Google为什么推新语言呢？我们可以不做这个事情，我们就使用别人做的事情，我们搭便车，一样可以提高我们生产的效率。但是这里有一个问题就是，如果我们永远是搭便车的方式，我们就比较会缺乏在编程语言维度解决问题的能力。什么叫编程语言维度解决问题？咱们中国整个公司工程师其实已经发展非常好了，经过这么多年的锻炼，在我们整个工具箱里面我们有很多的解决的方法，比如说库、比如说很好框架都没有问题，但是语言这个维度我们可能是相对比较缺失的一个维度，这就导致在整个工具箱环境里面可能缺了一环。

举两个例子。第一个例子就是前面圆心（阿里前端委员会主席）提到了，曾经有一段时间经常做各种JS Module的系统，这个Module系统用一个ComeJS方案解决就可以了，这个方案不是不好，而是有问题：是通过库和框架解决的，有一些东西做不到。比如说ComeJS是模块机制，而现在的机制是静态的。静态机制有好处，具体这里不讲。像模块机制，模块要在语言层面很好解决。我们曾经一度很接近这个的，举例子来讲，比如说我们讲玉帛做的CDJS的方案，虽然长得和ComeJS长得一样，实际上CDJS是非常静态化方案，需要静态分析得到结果，并不是完全是ComeJS。CDJS已经接近语言层级。

另外就是Async/Await，好多年之前有一个中国程序员老赵，他其实是一个Swift的程序员，他不是JS程序员，但是却做到了JS里面。我觉得整个中国程序员，我们的能力和思考其实没有问题的，但是我们没有在整个主线上，老赵做的工具非常好，但是他一直没有流行起来。

我想讲一下可能我们现在在开发新语言的问题上也还离得比较远，但是我们可能慢慢来，比如说DSL和IDE，我们已经在这方面可以不断探。比如说DSL，前面我们讲到小程序，其实里面就有很多DSL，每个公司都在做DSL。这个地方我们已经积累很多的经验，这个部分是从一个小的DSL逐渐将来可以走上更加完整或者通用的编程语言。

另外IDE也是提到了，现在整个语言其实不是单单语言本身，而是包含了整个工具链。如果我们熟悉、我们发现我们各个公司做这个东西里面，很多都是在做IDE以上的投资，包括阿里也会在这上面做投资，我在很多地方看到微信整个开发也提供了微信开发工具也是IDE。之前到中兴他们内部也做很多IDE。这一块也是我们可以考虑的一个问题。当然还有第三点，我们不一定现在马上做一个新东西，但是我们开始贡献线程语言，包括董韬博士提到中国程序员对于Flutter的贡献，已经非常显著了。
最后是参与编程语言标准制定。比如说JS的TC39，阿里在走这样一个流程，可能在这个流程当中。我在这边也同步一下，我们360的情况，上周我们已经向AKMART提出TC39的申请，我们马上可以参与这样一个事情。

总结
工欲善其事，必先利其器。对于我们程序员来讲，语言就是我们一个最重要的利器。所以，我希望今天演讲的一些比较零碎、松散的想法，能够给大家在整个前端开发和编程语言方面带来更多的理解与思考。谢谢大家！
